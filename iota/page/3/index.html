<!DOCTYPE html>
<html lang="de">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="Ein Blog, zwei Themen. Die eher
	  technische Seite über das Internet der Dinge, IoT,
	  Automatisierung und Analytics. Und die menschliche Seite, es
	  gibt keine Abkürzung, über Motivation, Autonomie, Wissen,
	  Ziele und Lehre.">
    
    <meta name="author" content="Stefan Michaelis">

    <meta name="twitter:site" content="@stmichaelis">
<meta name="twitter:creator" content="@stmichaelis">

<meta name="twitter:title" content="Stefan Michaelis - Blog" />
<meta name="twitter:description" content="Ein Blog, zwei Themen. Die eher
	  technische Seite über das Internet der Dinge, IoT,
	  Automatisierung und Analytics. Und die menschliche Seite, es
	  gibt keine Abkürzung, über Motivation, Autonomie, Wissen,
	  Ziele und Lehre." />


    
    <title>Stefan Michaelis - Blog</title>

    
    <link href="https://blog.stefan-michaelis.name/iota/index.xml" rel="alternate" type="application/rss+xml" title="Stefan Michaelis - Blog" />
    <link href="https://blog.stefan-michaelis.name/iota/index.xml" rel="feed" type="application/rss+xml" title="Stefan Michaelis - Blog" />
    

    
    <link href="https://blog.stefan-michaelis.name/css/bootstrap.min.css" rel="stylesheet">
    

    
    <link href="https://blog.stefan-michaelis.name/css/clean-blog.min.css" rel="stylesheet">
    <link href="https://blog.stefan-michaelis.name/css/shariff.min.css" rel="stylesheet">
    <link href="https://blog.stefan-michaelis.name/css/clean-blog-custom.css" rel="stylesheet">
    <link href="https://blog.stefan-michaelis.name/css/syntax.css" rel="stylesheet">

    
    
    <link href="https://blog.stefan-michaelis.name/css/font-awesome.min.css" rel="stylesheet">
        <link href="https://blog.stefan-michaelis.name/css/fonts.css" rel="stylesheet">
    

</head>

<body>

    
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
		<a class="navbar-brand" href="//www.stefan-michaelis.name" style="font-family: 'Reenie Beanie';font-size:1.6em;">Stefan Michaelis</a>
            </div>

            
<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
  <ul class="nav navbar-nav navbar-right">
    <li>
      <a href="https://blog.stefan-michaelis.name">Blog</a>
    </li>
    <li>
      <a href="//www.stefan-michaelis.name/technology/de">Projekte</a>
    </li>

    <li>
      <a href="//www.stefan-michaelis.name/contact/de" rel="nofollow">Kontakt</a>
    </li>
  </ul>
</div>


        </div>
        
    </nav>


    
    
    <header class="intro-header" style="background-image: url('https://blog.stefan-michaelis.name/img/iota-bg.jpg')">
      
     <div class="container" style="width: 100%; background: linear-gradient( rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.35) )">
       <div class="row">
         <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
           <div class="site-heading">
             <h1>IoTA</h1>
               <hr class="small">
	       <span class="subheading"><strong>Internet of Things Automation und das lernende Smart Home</strong></span>
           </div>
         </div>
       </div>
     </div>
    </header>

    
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
                             <div class="post-preview">
                 <a href="https://blog.stefan-michaelis.name/iota/der-feind-im-eigenen-haus-die-rueckkehr/">
                      <h2 class="post-title">Der Feind im eigenen Haus - Die Rückkehr</h2>
                      <h3 class="post-subtitle">Instabiles Internet: Analysen, Spekulationen und unbefriedigende Ergebnisse</h3>
                 </a>
		 <p>Jetzt ist es hier einige Zeit recht ruhig gewesen, woran lag das? Nun,
zu Einem gab es viel zu tun (wann gibt es das nicht?) und zu Anderem
war da immer noch diese lästige Problem der instabilen
Internetverbindung, was doch immer irgendwie im Hinterkopf schwebt
(genaus wie die Klagen zuhause, dass Internet wäre ständig weg). Die
Analysen und Spekulationen haben entsprechend Zeit gekostet bis
immerhin ein (nicht ganz befriedigender) Workaround zu finden war.
</p>

<h2 id="was-bisher-geschah">Was bisher geschah</h2>

<p>In
<a href="https://blog.stefan-michaelis.name/iota/der-feind-in-meinem-haus/">Der Feind in meinem Haus</a> ging
es das erste Mal um Probleme mit dem Internet. Damals brach unregelmäßig
die Verbindung vom Router zum WAN ab, Ursache unklar. Erste
Vermutungen brachten einen mDNS-Storm verursacht durch
Google-castfähige Geräte ins Spiel, was ungefähr auch zu diesem
Zeitpunkt durch die Presse ging. Das mDNS-Problem war real, die
(alleinige) Ursache war es aber nicht. Also weitersuchen und
letztendlich bliebe nur eine Störungsmeldung beim Provider.</p>

<h2 id="ursachensuche">Ursachensuche</h2>

<p>Um dem Provider nicht unpräzise mitteilen zu müssen: <em>Internet fällt
aus.</em> Wann, wie oft? <em>Weiß nicht, gefühlt immer dann wenn man es
braucht.</em> war der erste Schritt überhaupt einmal mitzuloggen, wann es
überhaupt zu Problemen kommt. Vielleicht zeigen sich da schon
Regelmäßigkeiten. Als schnell ein Skript erstellt, das eine externe
Webseite aufruft, auf dem Raspberry, der sowieso 24/7 läuft,
installiert und erst einmal Daten gesammelt.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="k">while</span> true<span class="p">;</span> <span class="k">do</span>
    <span class="nv">dt</span><span class="o">=</span><span class="k">$(</span>date +%Y%m%d_%H%M%S<span class="k">)</span>
    wget -q --tries<span class="o">=</span><span class="m">5</span> --timeout<span class="o">=</span><span class="m">30</span> --spider http://&lt;seite_des_vertrauens.com&gt;
    
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dt</span><span class="s2">:Online&#34;</span>
    <span class="k">else</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$dt</span><span class="s2">:Offline&#34;</span>
    <span class="k">fi</span>
    sleep <span class="m">30</span>
<span class="k">done</span></code></pre></div>
<p>Die Auswertungen geben dem Gefühl der &ldquo;ständigen&rdquo; Ausfälle wenigstens
ein konkretes Gesicht: Wie lange, wie oft?</p>

<img src="/images/ausfallzeitjeTag.png" alt="Ausfallzeit je Tag" class="img-responsive center-block">

<div class="caption">Ausfallzeiten je Tag zeigen keine offensichtlichbegründbaren Besonderheiten</div>

<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>lubridate<span class="p">)</span>

du <span class="o">&lt;-</span> read_delim<span class="p">(</span><span class="s">&#34;dsluptime.log&#34;</span><span class="p">,</span> delim <span class="o">=</span> <span class="s">&#34;:&#34;</span><span class="p">,</span>
                 col_names <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;Time&#34;</span><span class="p">,</span> <span class="s">&#34;Status&#34;</span><span class="p">),</span>
                 col_types <span class="o">=</span> cols<span class="p">(</span>
                     Time <span class="o">=</span> col_datetime<span class="p">(</span><span class="s">&#34;%Y%m%d_%H%M%S&#34;</span><span class="p">),</span>
                     Status <span class="o">=</span> col_factor<span class="p">(</span>levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;Offline&#34;</span><span class="p">,</span> <span class="s">&#34;Online&#34;</span><span class="p">))</span>
                 <span class="p">))</span>

du <span class="o">%&gt;%</span>
    filter<span class="p">(</span>Status <span class="o">==</span>  <span class="s">&#34;Offline&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>day<span class="o">=</span>wday<span class="p">(</span>Time<span class="p">,</span> label <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> week_start <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">%&gt;%</span>
    count<span class="p">(</span>day<span class="p">)</span> <span class="o">%&gt;%</span>
    ggplot<span class="p">(</span>mapping <span class="o">=</span> aes<span class="p">(</span>x <span class="o">=</span> day<span class="p">,</span> y <span class="o">=</span> n <span class="o">*</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
    geom_col<span class="p">()</span> <span class="o">+</span> labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&#34;Wochentag&#34;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&#34;Summe Ausfallzeit [Minuten]&#34;</span><span class="p">)</span> </code></pre></div>
<p>Die Summe der Ausfallzeiten je Tag ist zwar nicht gleichverteilt, aber
richtig interpretierbar sieht es auch nicht aus. Auffällig sind die im
Vergleich geringen Ausfälle an Freitagen, das Wochenende ist
(überraschenderweise) ebenfalls leicht weniger betroffen, weicht aber
nicht allzu stark von den übrigen Wochentagen ab.</p>

<img src="/images/ausfallzeitjeStunde.png" alt="Ausfallzeit je Stunde" class="img-responsive center-block">

<div class="caption">Die Ausfallzeiten je Stunde zeigen Häufungen im Abendbereich</div>

<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">du <span class="o">%&gt;%</span>
    filter<span class="p">(</span>Status <span class="o">==</span>  <span class="s">&#34;Offline&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>day<span class="o">=</span>hour<span class="p">(</span>Time<span class="p">))</span> <span class="o">%&gt;%</span>
    count<span class="p">(</span>day<span class="p">)</span> <span class="o">%&gt;%</span>
    ggplot<span class="p">(</span>mapping <span class="o">=</span> aes<span class="p">(</span>x <span class="o">=</span> day<span class="p">,</span> y <span class="o">=</span> n <span class="o">*</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
    geom_col<span class="p">()</span> <span class="o">+</span> labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&#34;Stunde&#34;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&#34;Summe Ausfallzeit [Minuten]&#34;</span><span class="p">)</span> </code></pre></div>
<p>Bei der Betrachtung der Ausfallzeiten gestaffelt nach Stunden zeigen
sich die meisten Ausfälle in den Abendstunden, was eine gewisse
Abhängigkeit von der generellen Auslastung erahnen ließe.</p>

<img src="/images/ausfalldauerTag.png" alt="Ausfalldauern je Tag" class="img-responsive center-block">

<div class="caption">Die Ausfalldauern je Tag zeigen nur bedingt Korrelationen mit dem Gesamtausfall</div>

<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">du <span class="o">%&gt;%</span>
    filter<span class="p">(</span>Status <span class="o">==</span>  <span class="s">&#34;Offline&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>date <span class="o">=</span> as_date<span class="p">(</span>Time<span class="p">))</span> <span class="o">%&gt;%</span>
    count<span class="p">(</span><span class="kp">date</span><span class="p">)</span> <span class="o">%&gt;%</span>
    mutate<span class="p">(</span>wday <span class="o">=</span> wday<span class="p">(</span><span class="kp">date</span><span class="p">,</span> label <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> week_start <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">%&gt;%</span>
    ggplot<span class="p">(</span>mapping <span class="o">=</span> aes<span class="p">(</span>x <span class="o">=</span> wday<span class="p">,</span> y <span class="o">=</span> n <span class="o">*</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
    geom_boxplot<span class="p">()</span>  <span class="o">+</span> labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&#34;Wochentag&#34;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&#34;Dauer je Ausfall [Minuten]&#34;</span><span class="p">)</span></code></pre></div>
<img src="/images/ausfalldauerStunde.png" alt="Ausfalldauern je Stunde" class="img-responsive center-block">

<div class="caption">Die Ausfalldauern je Stunde zeigen nur bedingt Korrelationen mit dem Gesamtausfall</div>

<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">du <span class="o">%&gt;%</span>
    filter<span class="p">(</span>Status <span class="o">==</span>  <span class="s">&#34;Offline&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>hour<span class="o">=</span>hour<span class="p">(</span>Time<span class="p">))</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>date <span class="o">=</span> as_date<span class="p">(</span>Time<span class="p">))</span> <span class="o">%&gt;%</span>
    count<span class="p">(</span>hour<span class="p">)</span> <span class="o">%&gt;%</span>
    ggplot<span class="p">(</span>mapping <span class="o">=</span> aes<span class="p">(</span>x <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>hour<span class="p">),</span> y <span class="o">=</span> n <span class="o">*</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
    geom_boxplot<span class="p">()</span> <span class="o">+</span> labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&#34;Stunde&#34;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&#34;Dauer je Ausfall [Minuten]&#34;</span><span class="p">)</span></code></pre></div>
<p>Die Boxplots der Ausfälle aufgeteilt jeweils nach Tagen und Stunden
(Summe innerhalb jedes einzelnen Tags, jeder einzelnen Stunde an jedem
Tag; d.h. zwei Ausfälle innerhalb derselben Stunde werden
zusammengefasst) sollen einen möglichen Zusammenhang zwischen den
Tagen/Stunden mit insgesamt einer hohen Ausfallzeit und der Dauer
innerhalb dieser Stunde zeigen. Bestätigt hat sich das nicht. Hohe
Werte für die Gesamtsumme (z.B. in den Abendstunden) ergeben sich nur
durch mehr Ausfälle an mehreren Tagen. Insgesamt zeigt sich aber eine
hohe Varianz wie schlimm/lang ein Ausfall sein kann.</p>

<h2 id="lösungsversuche">Lösungsversuche</h2>

<p>Damit scheint dann aber fast klar: Der Provider ist schuld und der Knoten
überbucht. In den Abendstunden häufen sich die Ausfälle, wenn alle
anderen auch Datenverkehr erzeugen. Also wird nichts anderes übrig
bleiben als ein Supporticket zu öffnen und eine Lösung zu suchen,
hmpf. So der Plan. Bis wir in Urlaub gefahren sind. Das Ticket ist aus
Trägheit noch nicht eröffnet, schließlich funktioniert der
Internetzugang irgendwie ja doch immer mal wieder, und Lust auf
Gespräche mit der Hotline besteht auch nicht.</p>

<p>Und im Urlaub? Nur ein einziger kurzer Miniausfall, was auch alle möglichen
Ursachen haben kann. Sollte das Problem doch bei uns im Haus liegen?
Während des Urlaubs war WLAN komplett deaktiviert, Internetverkehr nur
durch das Skript zum Verbindungsstatus und Kleinigkeiten wie hin und wieder
mal ein NTP-Synchronisation.</p>

<h3 id="wlan-jetzt-woanders">WLAN jetzt woanders</h3>

<p>Die Easybox 804 wird in Foren gerne für ihr WLAN kritisiert. Falls
dort das Problem läge, ließe sich das mit anderer Hardware
lösen. Gefallen ist die Wahl auf einen
<a href="https://www.ubnt.com/unifi/unifi-ap-ac-lite/">Ubiquit Unifi Accesspoint AC AP Lite</a>,
der in Bewertungen als recht konfigurierbar und stabil gilt, aber für kleine
Setups eine recht umständliche zu nutzende Konfigurationssoftware
besitzt. Die Reichweite der Easybox war zwar in Ordnung, aber ein
zweiter Accesspoint sollte eh die Abdeckung verbessern.</p>

<p>Angeschafft, konfiguriert, WLAN an der Easybox abgeschaltet, und
geholfen hat es nichts.</p>

<p>Bis zu dem Zeitpunkt als während des Ausräumens der Waschmaschine
wieder der Ruf kam: &ldquo;Kein Internet!&rdquo;. Ein zufälliger Blick auf den
Switch zeigte zwei wild blinkende LEDs, merkwürdig. Gehören tun sie zum
neuen Access Point und dem Router. Da war wohl gerade ziemlich Last
auf der Verbindung und über den Router sollte eben nur Datenverkehr
ins Internet gehen. Im Wohnzimmer zeigt die beste Gattin der Welt zum
Beweis des fehlenden Internets auf ihr Huawei P10. Auch andere Geräte
im Haus haben kein Netz und der Router selbst loggt wieder seine
WAN-Disconnects. Die Bitte, das P10 auszuschalten zeigt zunächst keine
Wirkung (wie auch, Android-Smartphones sind ja nicht wirklich aus wenn
der Bildschirm aus ist, sondern treiben wer weiß was im Hintergrund)
und erst das echte Herunterfahren bringt die LEDs zum Schweigen,
bzw. Dauerleuchten. Internet ist prompt auch wieder da&hellip;</p>

<h3 id="logging-voraus">Logging voraus</h3>

<p>Da wäre als ein Kandidat als mögliche Ursache für die
Verbindungsabbrüche vorhanden, aber was macht das Smartphone da
überhaupt? Wird der Router überlastet wie potenziell bei den
mDNS-Broadcasts (wobei der ein wenig Datenverkehr schon aushalten
sollte).</p>

<p>Jetzt hat sich die Anschaffung eines Smart-Switches doch noch
gelohnt. Den Port zum Festnetz-PC als Monitoringport konfiguriert und
Wireshark mitlaufen lassen um zu sehen, wie viel Datenverkehr wohin
überhaupt vorkommt.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Aufzeichnung nur für einen Client (hier das Smartphone)
</span><span class="c1"># und Beschränkung auf 50 MByte-Dateien
</span><span class="c1"></span>dumpcap -i eth0 - -b filesize:50000 -f <span class="s2">&#34;host &lt;clientip&gt;&#34;</span> -w trace.pcap</code></pre></div>
<p>Und in der Tat zeigt das Log gleich mehrere Datenverbindungen zu
unterschiedlichen IP-Adressen und volle Auslastung im Upload und auch
nicht wenig im Download, allerdings nicht an der
Maximalgeschwindigkeit. Immerhin besitzen wir hier eine ultraschnelle
Breitbandanbindung mit <em>bis zu</em> 16 MBit/s im Down- und 1 MBit/s im
Upstream. Und ich habe mal gedacht, wir würden im Ruhrgebiet, einer
der dichtbesiedelsten Region Deutschlands, und nicht auf dem Land leben.</p>

<p>Im P10 selbst lässt sich zusätzlich auch für WLAN mit immerhin
stündlicher Auflösung der Datenverbrauch von Apps anzeigen. Sortiert
nach Datenvolumen zeigen sich die üblichen Verdächtigen: Google Fotos,
Google-Backup-Transferdienst, K9-Mail, WhatsApp, PlayStore, HiCare,
Wetterdatenservice, Instagram. Im Wireshark-Trace lässt sich dies über
Reverse-Lookup der IP-Adressen zumindest teilweise nachvollziehen,
jeglicher auffälliger Traffic würde darin aber vermutlich
untergehen.</p>

<h3 id="energiesparen">Energiesparen</h3>

<p>Aber warum stürmen die Apps nahezu gleichzeitig auf das WLAN los?
Eines der Feature (manche bezeichnen es aber auch als Bug) ist das
aggressive Energiesparen im angepassten Android von Huawei. Kein
Wunder, wenn die Prozesse beschränkt werden, schlafen liegen und dann
gesammelt bei jeder sich bietenden Gelegenheit in den Wettbewerb der
schnellsten Aktualisierung treten. Nur lässt sich daran etwas ändern
und verschwinden die Verbindungsabbrüche, wenn sich die
Datenverbindungen zeitlich entzerren lassen?</p>

<p>In
der
<a href="https://consumer.huawei.com/de/support/how-to/detail-troubleshooting/?resourceId=898690">Huawei FAQ</a> gibt
es sogar einen eigenen Unterpunkt, der sich mit dem Wechsel auf WLAN
beschäftigt, was auch der Fall wäre wenn das Gerät aus dem Standby
erwacht. Zitat:</p>

<blockquote>
<p>Nach der Verbindung mit einem WLAN-Netzwerk oder beim Umschalten
zwischen einer WLAN- und einer mobilen Datenverbindung, warten Sie
etwa 30 Sekunden, bevor Sie Apps verwenden, und überprüfen Sie dann,
ob die Internet-Geschwindigkeit normal ist.</p>
</blockquote>

<p>Strom sparen (versuchen) bis zum letzten Tropfen, aber die User
Experience so weit vernachlässigen, dass es eines eigenen FAQ-Eintrags
bedarf, ts. Das lässt sich technisch auch anders lösen.</p>

<p>Ein Versuch dies zu entzerren war die Energiespareinstellungen für die
intensivsten Apps, insbesondere Fotos, zu deaktivieren und analog den
unbeschränkten Datenzugriff, auch im Hintergrund, zu aktivieren. Wo
diese Einstellungen liegen lohnt gar nicht zu dokumentieren, das
ändert sich anscheinend öfter, denn fast alle Beiträge mit
Beschreibungen, wo diese zu finden wären, waren schon veraltet. Für
nicht ganz so wichtige Apps wurde der Datenzugriff gleich ganz
verboten&hellip;</p>

<p>Aber es lässt sich schon erahnen: Gebracht hat es nichts. Über
Maßnahmen wie Löschen des Caches oder Einstellungen in den Apps müssen
wir auch nicht weiter reden. Irgendwann einmal hatte Google Fotos auch
die Einstellung nur beim Laden zu sichern. Gone with the wind&hellip;</p>

<h3 id="bufferbloat">Bufferbloat</h3>

<p>Eigentlich ist das Internet auf Fairness aufgebaut. TCP-Verbindungen
sollten sich schön die verfügbare Bandbreite aufteilen, so dass für
jeden etwas bleibt. Klar, insbesondere im schmalen Uplink bleibt dann
nicht mehr viel übrig, aber ganz ausgehungert sollte keine Verbindung sein. Bis
die Recherchen rund um die Verbindungsabbrüche auf die Seite
über <a href="https://www.bufferbloat.net/projects/">Bufferbloat</a> geführt
haben. Bufferbloat? Aber Speedtests waren doch alle in Ordnung? Nach
Schwierigkeiten als der Anschluss noch neu war haben sich die
Speedtests diverser Webseiten fast auf dem Maximum des Anschlusses
eingependelt.</p>

<p>Aber Bufferbloat ist anders. Ist der Puffer bei einem der
Geräte auf der Wegstrecke, und bei DSL ist dies üblicherweise der Router, zu groß,
funktionieren die Ausgleichsmechanismen nicht mehr. Einzelne Pakete
oder langsamere Datenverbindungen stecken dann im Puffer fest, die
Latenzen schießen in die Höhe. Mittels einem kontinuierlichen Ping
während eines Speedtests oder Tests
wie <a href="https://fast.com/de">fast.com</a> von Netflix lässt sich das Problem
relativ leicht nachvollziehen: Steigt die Latenz während einer
ausgelasteten Verbindung an gibt es vermutlich ein Bufferbloat-Problem
und letztendlich leidet auch hier die Nutzererfahrung. Und siehe da:
Insbesondere im Uplink steigt die Latenz um den Faktor 10. Ist die
Easybox die Ursache? Danach sieht es aus, müsste aber im Tausch mit
anderen Geräten verifiziert werden. Vielleicht bekommt man eben doch
nur das, was man bezahlt.</p>

<p>Aber, wir erinnern uns: Es sind nicht nur einzelne Verbindungen und
Endgeräte, die den Kürzeren ziehen, auch die gesamte WAN-Verbindung
fällt regelmäßig aus.</p>

<h3 id="workaround-drosseln">Workaround: Drosseln</h3>

<p>So nicht zu erklären sind eben diese Abbrüche. Um eine Überlastung des
Routers auszuschließen bleibt nur noch die Möglichkeit den
Datenverkehr unter die Maximalgeschwindigkeit zu drosseln. Der Unifi
Access Point bietet die Möglichkeit dies für gesamte SSIDs und sogar
einzelne Clients zu tun. Hurra! Dann wird das P10 eben
gebremst. Funktioniert aber nicht, hmpf. Scheint ein Problem in der
aktuellen Firmware zu sein. Laut Ubiquiti-Foren kommt es öfter
vor, dass Funktionen in der einen Firmware funktionieren und der
nächsten wieder nicht. Auf Abhilfe zu warten ist nicht zielführend,
also wieder auf den Smart Switch zurückgegriffen und den ganzen Port
gedrosselt. Sicherheitshalber auf 10 MBit/s im Down- und 800 KBit/s im
Uplink, was noch genügend Reserven zur Maximalrate lässt, aber gerade
für Smartphones beim Browsen nicht allzu sehr auffällt. Dumm nur, dass
damit auch alle anderen WLAN-Geräte betroffen sind, die vielleicht
gerne doch in voller Geschwindigkeit im Heimnetz unterwegs gewesen
wären.</p>

<p>Aber siehe da, seit der Drosselung <strong>kein einziger</strong>
WAN-Verbindungsabbruch mehr. Natürlich besteht das Problem der im
Endgerät lokal verstopften Leitung oder von Bufferbloat generell immer
noch, allerdings in deutlich abgeschwächter Form und der Eindruck
<em>Internet weg</em> entsteht gar nicht mehr. Damit lässt sich, zumindest
temporär, leben.</p>

<h2 id="das-ende">Das Ende</h2>

<p>Die eigentliche Ursache ist aber immer noch unklar und doch ein Fall
für eine Störungsmeldung an den Provider. Überlastung, nur weil der
Link voll ausgenutzt wird, dürfte auch im Consumergerät kein Problem
sein. Mit üblichen Speedtests, auch mehrerer Datenströme parallel,
ließen sich die Abbrüche nicht nachstellen.</p>

<p>Aber nicht zu jedem Ausfall der externen Internetanbindung sah der
Datenverkehr nach einer wilden Ansammlung angestauter Datenverbindung
aus. Ein einzelner Datenstrom konnte ebenso zum Ausfall führen.</p>

<img src="/images/quictrace.png" alt="Wireshark Trace" class="img-responsive center-block">

<div class="caption">Wireshark-Trace einer einzelnen QUIC-Verbindung mit maximaler Uploadrate</div>


<p>QUIC (alias GQUIC), was ist
<a href="https://de.wikipedia.org/wiki/Quick_UDP_Internet_Connections">QUIC</a>?
UDP-Datenverkehr und das auch noch auf Port 443 (https), welchen Sinn
hat das denn?</p>

<p>QUIC ist ein auf UDP basierendes Protokoll, von Google ins Leben
gerufen, als Testfeld für neue Managementalgorithmen für die
Datenverbindung, unter anderem weil sich mit den normalen
Standardisierungsprozessen z.B. auf TCP zu wenig/langsam Einfluss
nehmen ließe. QUIC selbst ist schon einige Jahre alt (ich werde auch
alt, das Protokoll kannte ich noch nicht) und findet zunehmend Einsatz in
Google-Produkten. Und in der Tat zeigt ein Reverse-Lookup für die
IP-Adresse auf Google-Server. Das muss allerdings noch nicht auf ein
Google-Produkt als Quelle hinweisen, da unter Umständen auch die
Nutzung von Google-APIs durch Drittentwickler QUIC nutzen könnte,
allerdings waren diverse Google-Dienste und insbesondere die Foto-App
in der Summe des Datenvolumens immer vorne mit dabei.</p>

<p>Ein Durchsatztest für QUIC scheint noch nicht zu existieren, das
Protokoll ist auch noch im Standardisierungsprozess, also fix selbst einen
Loadtest auf Basis einer freien Implementierung
entworfen:
<a href="https://github.com/stmichaelis/quic-loadtest">QUIC-Loadtest</a>.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Server
</span><span class="c1"></span>quic-loadtest -s &lt;publicip&gt;:4242 -q -p <span class="m">1300</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Client
</span><span class="c1"></span>quic-loadtest -c &lt;publicip&gt;:4242 -d <span class="m">600</span> -q -p <span class="m">1300</span></code></pre></div>
<p>Aber auch dieser Test zeigt wunderbaren Durchsatz im Bereich der
zugesicherten Geschwindigkeit. Als einziger offensichtlicher
Unterschied zum Trace bleibt nur noch der Port 443. Also das
Experiment noch einmal wiederholt, in diesem Durchlauf dann mit
privilegiertem Port für den Server (entsprechend als Root, schön öffentlich
erreichbar im gesamten Internet, also bloß schnell mit dem Test sein).</p>

<img src="/images/netzwerkverlauf.png" alt="Netzwerkverlauf" class="img-responsive center-block">

<div class="caption">Netzwerkverlauf/Durchsatz bis zum Verbindungsabbruch</div>


<p>Und jetzt - endlich - bricht die WAN-Verbindung ab. Wiederholungen
zeigen immer das gleiche Bild: Perfekter Durchsatz auf Port 4242
(ebenso auf 30, ebenfalls im Bereich der privilegierten Ports, aber
keinem Protokoll zugeordnet), auf Port 443 dagegen nach 2 Minuten, spätestens
nach knapp 10 Minuten Zwangstrennung. Ob durch den Router oder von
außerhalb durch den Provider ist aus dem Log nicht zu entnehmen. Aber
spätestens ab hier sieht es nach Absicht aus.</p>

<p>Warum nur wird die Verbindung nur bei UDP-Verkehr auf dem HTTPS-Port
und nur unter Volllast beendet? Soll das eine Denial-of-Service-Abwehr
sein, da UPD-Verkehr auf diesem Port eher ungewöhnlich ist (aber mit
Google als Hauptnutzer dann doch wieder nicht so ungewöhnlich). Liegt
einfach ein Fehlkonfiguration vor? Sind die Experimente nicht korrekt
und das Problem liegt doch irgendwo anders? Um sicher zu gehen wären
weitere und unabhängige Tests notwendig. Und warum sollte das
keinem vorher aufgefallen sein? Ein dumme Kombination aus Anschluss,
Router und Endgeräten?</p>

<p>Der First-Level-Support des Providers zeigte sich zwar noch
interessiert und wollte das Vorgehen zur Reproduktion des Ausfalls an
die Technik weitergeben, ein Techniker würde sich direkt zeitnah
melden, passiert ist aber nichts.</p>

<p>Eine endgültige Auflösung wird es wohl nicht geben: Der Anschluss beim
Provider ist sicherheitshalber gekündigt und das P10 hat Kontakt mit
der Badewanne gehabt&hellip;</p>
		 <div class="shariff" data-title="Der Feind im eigenen Haus - Die Rückkehr" data-theme="white" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]"  data-mail-url="mailto:"></div>
                 <p class="post-meta"><a href="http://www.stefan-michaelis.name">Stefan Michaelis</a> am 21.08.2018
                 </p>
               </div>
               <hr>

          
                             <div class="post-preview">
                 <a href="https://blog.stefan-michaelis.name/iota/remote-kde-desktop-mit-krfb/">
                      <h2 class="post-title">Remote KDE Desktop mit KRFB</h2>
                      <h3 class="post-subtitle">Verbindung und Ports absichern</h3>
                 </a>
		 <p>Hin und wieder ist es nötig auf den Desktop eines entfernten, offen im
Internet zu erreichenden, Rechner zuzugreifen. Ein Standardmethode ist
dabei VNC, zu dem es eine Vielzahl an Implementierungen gibt. Soll der
normale, bereits laufende, KDE-Desktop frei gegeben werden kann dies
über die Anwendung <code>krfb</code> anstelle einer eigenen, neuen VNC-Sitzung
erfolgen.</p>

<div class="row">
     <div class="col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
     	  <img src="/images/krfb.png" class="img-responsive" />
     </div>
</div>


<p>Um den Zugriff, insbesondere den unbeaufsichtigten Zugriff,
abzusichern gibt es dazu ein paar einfache Möglichkeiten:</p>

<ol>
<li>Sicheres Passwort wählen. Zufällig und lang.</li>
<li>Standardport von 5900 auf einen anderen Port ändern. Diese Maßnahme
alleine bringt nur wenig Sicherheit, sondern hilft nur den Scan auf
offene VNC-Ports durch Standardskripte zu verhindern.</li>
<li>Externen Zugriff auf den VNC-Port verhindern.</li>
</ol>

<p>Letzteres erzwingt dann den Zugriff auf die Desktopfreigabe durch eine
sichere Umleitung wie einen ssh-Tunnel.</p>

<p>Der Zugriff auf den Port kann per <code>iptables</code> gesperrt werden:</p>

<pre><code>iptables -A INPUT -p tcp -i &lt;eth0&gt; --dport &lt;5912&gt; -j DROP
</code></pre>

<p>Werte in spitzen Klammern müssen an das eigene System angepasst
werden, d.h. der Name des Netzwerkinterfaces und der Port unter dem
<code>krfb</code> auf Anfragen horcht. Diese Regel ist nur bis zu einem Neustart
des Systems gültig.</p>

<p>Ein ssh-Tunnel wird dann auf dem Rechner, von dem aus auf die Freigabe
zugegriffen werden soll, auf der Kommandozeile aufgebaut:</p>

<pre><code>ssh -N -L 5900:&lt;remotehost&gt;:5912 &lt;remotehost&gt;
</code></pre>

<p><code>&lt;remotehost&gt;</code> ist die IP-Adresse des entfernten Rechners. Der Zugriff
auf den Desktop, z.B. mit <code>krdc</code> als Client erfolgt dann über die
Angabe von <code>localhost:5900</code>.</p>

<p>Bei Nutzung mit den Standardeinstellungen von <code>krfb</code> für das
Framebuffermodul zur Bilderstellung (xcb) und einem
Multimonitorbetrieb war dabei das Bild des entfernten Rechners
eingefroren. Abhilfe gebracht hat eine Umstellung auf <code>qt</code> für das
Framebuffermodul.</p>

		 <div class="shariff" data-title="Remote KDE Desktop mit KRFB" data-theme="white" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]"  data-mail-url="mailto:"></div>
                 <p class="post-meta"><a href="http://www.stefan-michaelis.name">Stefan Michaelis</a> am 25.04.2018
                 </p>
               </div>
               <hr>

          
                             <div class="post-preview">
                 <a href="https://blog.stefan-michaelis.name/iota/homeserver1/">
                      <h2 class="post-title">Homeserver</h2>
                      <h3 class="post-subtitle">Die Hardware</h3>
                 </a>
		 <p>Das schöne an der Verkabelung mit KNX ist der dezentrale Ansatz und
die Eigenintelligenz der Komponenten. Fällt eine Komponente aus läuft
der Rest weiter. Je nach Komponente kann dies zwar unterschiedlich
fatal sein (bei der Heizungssteuerung fällt direkt eine ganze Etage
aus. Bei der Spannungsversorgung dann doch das gesamte System&hellip;),
aber wie oft das vorkommt muss sich im Laufe der Jahre zeigen.</p>

<p>Damit ist aber auch schon einmal sichergestellt, dass die
Grundfunktionen zuverlässig da sind. Nur so richtig <em>intelligent</em> sind die
Komponenten dann wieder nicht. Also muss ein eigener Homeserver her,
der später als Spielwiese (hoffentlich) für die spannenden Experimente
dient.</p>

<p>Im Wohnzimmer sind dazu an einer Stelle Stromanschluss, Ethernetkabel
und KNX-Leitung vorhanden. Hier wird der Server als zentrale
Steuereinheit auf Basis des bekannte Raspberry Pi später montiert werden.</p>

<img src="/images/Homeserver_Gehaeuse_Vorderseite.jpg" alt="Homeserver Vorderseite" class="img-responsive center-block">

<div class="caption">Vorderseite des Homeserver-Gehäuses</div>


<p>Das Gehäuse wird dazu aus einfachem Sperrholz gefertigt und bekommt
einen passenden Ausschnitt um das Touchdisplay zur Bedienung
aufzunehmen.</p>

<img src="/images/Homeserver_Gehaeuse_Rueckseite.jpg" alt="Homeserver Rückseite" class="img-responsive center-block">

<div class="caption">Homeserver Rückseite</div>


<p>In der Rückseitenansicht sind die Viertelrundhölzer in den Ecken zu
sehen die dem Gehäuse einen etwas &ldquo;weicheren&rdquo; Charme verleihen. Das
Ganze wird verleimt, ggf. verspachtelt und geschliffen, und
abschließend lackiert<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>. Falls sich jemand wundert: Das Gehäuse ist
recht dick (knapp 6 cm) geworden und der Ausschnitt für das Display
asymmetrisch im Gehäuse. Optisch ließe sich durch eine kompaktere
Anordnung der Komponenten sicher eine flachere Bauweise erreichen, so
ist aber sichergestellt, dass alles später bequem in das Gehäuse
passt. Insbesondere das Netzteil verschwindet letztendlich im Bereich
rechts vom Display. Die Dicke erschließt sich beim Blick auf die gestackte
Anordnung aller Komponenten.</p>

<img src="/images/Homeserver_Display_Rueckseite.jpg" alt="Homeserver Display" class="img-responsive center-block">

<div class="caption">Display mit Raspberry Pi und KNX-Ankopplung</div>


<p>Die Hardware besteht aus:</p>

<ul>
<li><a href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/README.md">Raspberry
Pi</a>
(hier noch in der Version 2, die aktuelle Version 3 sollte aber
mindestens genauso gut/besser funktionieren), ca. 35 €</li>
<li><a href="https://www.raspberrypi.org/documentation/hardware/display/README.md">7-Zoll
Touchdisplay</a>,
offizielles Display, ca. 70 €</li>
<li>Micro-USB-Netzteil 2,5A, ca. 10 €</li>
<li>Micro-SD-Karte 16 GB, ca. 10 €</li>
<li><a href="http://busware.de/tiki-index.php?page=PIG_OW">PIGATOR-HAT</a> von
Busware, ca. 45 € inkl. Befestigungsset. Hierbei handelt es sich um
das Modul mit Echtzeituhr (RTC) und 1-Wire-Busanschluss. Für 10 € weniger
gibt es das auch als Aufsteckmodul ohne weitere Funktion. Eine RTC
ist hilfreich, ließe sich aber auch separat nachrüsten.</li>
<li><a href="http://shop.busware.de/product_info.php/cPath/1_32_33/products_id/105">KNX-Pigator</a>
für die Busanbindung, ca. 40 €.</li>
</ul>

<p>Die letzten beiden Komponenten dienen für den Zugriff auf den KNX-Bus
und lassen sich über die passende Software auf dem Raspberry Pi auch
als Router zur Programmierung der Komponenten einsetzen. Schön an
dieser Lösung ist alle Komponenten passend zueinander und an einem
Platz zu haben.</p>

<p>Da diese Komponenten alle rund um den Raspberry Pi herum entworfen
sind passen sie übereinander, ergeben aber auch einen entsprechend
dicken Aufbau. Die Stromversorgung wird am Display eingesteckt und
über die roten/schwarzen Kabel der Raspberry Pi von dort aus
betrieben.</p>

<p>Alternativ kann auch ein professioneller Router für die
Elektroverteilung oder eine herkömmliche KNX-USB-Schnittstelle
eingesetzt werden, was die Programmierung des KNX-Busses auch ohne
verfügbaren Raspberry Pi ermöglicht.</p>

<p>Statt der Kombination Raspberry Pi + Display ist auch eine Variante
mit Tablet denkbar, welches wiederum zur Steuerung auf eine
Weboberfläche auf dem Raspberry zugreift.</p>

<img src="/images/Homeserver_Montiert.jpg" alt="Homeserver montiert" class="img-responsive center-block">

<div class="caption">Fertig an der Wand montierter Homeserver mit Raspbian-Linux</div>


<img src="/images/Homeserver_MontiertTotale.jpg" alt="/images/Homeserver_MontiertTotale.jpg" class="img-responsive center-block">


<p>An der Wand montiert wirkt das gesamte Gehäuse allerdings bei weitem
nicht so dick und klobig wie noch während der Anfertigung. Als Basis
für die weitere Software dient ein herkömmliches Raspbian-Linux.</p>

<p>Das Grundsystem als Plattform läuft damit, im nächsten Schritt geht es darum
den Zugriff auf den KNX-Bus zu ermöglichen und auch eine Steuerung zu
implementieren.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Notiz an mich: Lackieren ist gar nicht einfach und kein Selbstläufer. Tropfen, Nasen, Flecken, alles dabei. Für das nächste mal besser überlegen und testen wie das Ergebnis professioneller wird.
 <a class="footnote-return" href="#fnref:1"> ↩</a></li>
</ol>
</div>

		 <div class="shariff" data-title="Homeserver" data-theme="white" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]"  data-mail-url="mailto:"></div>
                 <p class="post-meta"><a href="http://www.stefan-michaelis.name">Stefan Michaelis</a> am 04.04.2018
                 </p>
               </div>
               <hr>

          
                             <div class="post-preview">
                 <a href="https://blog.stefan-michaelis.name/iota/kalibrierung/">
                      <h2 class="post-title">Kalibrierung und Grundeinstellung</h2>
                      <h3 class="post-subtitle">Damit alles auf demselben Stand ist</h3>
                 </a>
		 

<p>Alle Komponenten sind installiert, beschriftet und warten auf die
Inbetriebnahme. Das Schöne am KNX-Bus ist der dezentrale
Aufbau. Grundsätzlich bringen alle Komponenten ihre eigene rudimentäre
Intelligenz mit und funktionieren auch ohne zentrale
Steuereinheit. Insbesondere für Grundfunktionen wie Licht und Heizung
ist dies essenziell da diese somit nicht von der Funktion einer
zentralen Komponente abhängig sind. Für komplexere Regelungen, die
aber wieder den Alltag nur netter machen, ist der Homeserver dann das
nette Addon.</p>

<h2 id="raumtemperatur">Raumtemperatur</h2>

<p>Spätestens zum Winter muss die Heizung betriebsbereit sein. Zur
Überwachung der Raumtemperaturen sind verschiedene Sensoren verfügbar:</p>

<ul>
<li>Über die <a href="https://www.jung.de/1987/produkte/technik/knx-system/knx-tastsensoren-f-50/">Jung Tastsensoren der Serie F50
Universal</a>
steht in jedem Raum ein Sensor am Lichtschalter zur Verfügung</li>
<li>Die Jung CO<sub>2</sub>-Sensoren (Wohn- und Schlafzimmer) stellen ebenfalls die Temperatur
bereit</li>
<li>In den Bädern sind kombiniert Feuchte-/Temperatursensoren der Elsner
vom Typ TH-UP verbaut</li>
<li>Letztendlich noch ein einzelner Raumtemperatursensor MDT
SCN-TS1UP.01 im Keller
<br /></li>
</ul>

<p>&hellip;und alle Sensoren zeigen (natürlich) etwas anderes an. Die
absolut korrekte Temperaturerfassung ist dabei gar nicht entscheidend,
sondern zur Einstellung der persönlichen Behaglichkeit müssen nur die
Level zwischen den Sensoren vergleichbar sein.</p>

<p>Dementsprechend den Außenfühler der Wetterstation hereingeholt, neben
jedem einzelnen Sensor platziert und nach einiger Wartezeit den Wert
dieses Sensors mit den KNX-Sensoren verglichen.</p>

<p>Am weitesten entfernt waren dabei die Jung-Sensoren (bis zu ~1,5 K),
gefolgt von den Elsner-Sensoren, während der MDT-Fühler identisch zur
(nicht zwangsweise richtigen) Temperatur der Wetterstation war.</p>

<p>Auffällig war dabei aber, dass die gemessene Temperatur der Sensoren
in den Jung-Tastern vom Betriebsmodus abhängig war. Dies bieten ein
beleuchtetes Mittelfeld neben den eigentlichen Tastflächen. Und die
Wärmeentwicklung scheint die Sensoren deutlich zu beeinflussen. Das
lässt sich natürlich in den Einstellungen kompensieren, macht aber
andere Einstellungen wie einen dunkleren Nachtmodus oder die
Abschaltung am Tag nicht wirklich praktikabel.</p>

<p>Die Elsner-Sensoren weisen im Handbuch darauf hin, dass es durch die
Wärmeentwicklung der Elektronik zur Beeinflussung der Messung kommt,
dies aber intern kompensiert wird, die Messwerte allerdings
dementsprechend erst nach einigen Minuten Laufzeit nach dem
Einschalten gültig sind.</p>

<p>Hier müsste Jung noch einmal nachbessern. Die Unterschiede ließen sich
zwar extern kompensieren, was aber ziemlich aufwändig ist.</p>

<h2 id="rollläden">Rollläden</h2>

<p>Einmal installiert funktionieren die Rollläden auch direkt auf
Tastendruck. Um aber später nette Funktionen wie einen automatischen
Sonnenschutz (nach dem Winter kommt der Sommer) nutzen zu können ist
es hilfreich absolute Positionen anfahren zu können. Dazu müssen aber
die Auf- und Abfahrzeiten dem Aktor bekannt gegeben werden. Also
Stoppuhr herausgeholt und alle Rollläden einmal hoch und wieder
herunter gefahren. In der Praxis waren die Verfahrzeiten nur gut 50 %
der voreingestellten Zeiten, was auch Sinn ergibt, denn wer möchte
schon vorher, dass der Rollläden schon in der Mitte stoppt weil er
meint er wäre in der Endposition angekommen.</p>

<p>In der Anleitung des MDT-Aktors steht dabei noch die Randbemerkung:
&ldquo;Bei nicht so hochwertigen Motoren können sich die Auf- und
Abfahrzeiten unterscheiden&rdquo;. Bei uns liegt die Differenz bei immerhin
2s. Dankeschön.</p>

<h2 id="dimmer">Dimmer</h2>

<p>Bei den Dimmern (zentrale Dimmer in klassischer
Phasenan-/abschnittstechnik) gibt (sollte) es nicht viel
einzustellen. Der Lasttyp gehört zumindest dazu.  Auffällig war aber
immerhin auch bei den von uns installierten Lampen, dass ein Wechsel
der Kennlinie vom Standard notwendig war. Erst die &ldquo;Logarithmische
Kennlinie&rdquo; hat ein zufriedenstellendes optisch scheinbares lineares
Dimmverhalten ergeben.</p>

<p>Die Grundeinstellung für den Einschaltwert liegt dabei noch im Bereich
90 %-70 %. Nur so ist den heutigen LED-Flutlichtern (Warum müssen die
immer so hell sein? Weil&rsquo;s geht?) auf ein angenehmes Maß beizukommen.</p>

<h2 id="schaltschwelle-präsenzmelder">Schaltschwelle Präsenzmelder</h2>

<p>Letztendlich muss auch die Einschaltschwelle für die Präsenzmelder,
die üblicherweise in den Fluren als Durchgangsbereichen installiert
sind, eingestellt werden. Letztendlich ist es hier Geschmackssache ab
wann dunkel zu dunkel ist. Sollten die Einstellbereiche nicht
ausreichend lässt sich noch weiterhin über den Reflexionsfaktor der
Umgebung eine weitere Abstimmungsmöglichkeit konfigurieren (MDT
Präsenzmelder).</p>

<p>Sind alle diese Grundeinstellungen erfolgt steht der weiteren
Automatisierung im Heim eigentlich nichts weiter im Wege.</p>

		 <div class="shariff" data-title="Kalibrierung und Grundeinstellung" data-theme="white" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]"  data-mail-url="mailto:"></div>
                 <p class="post-meta"><a href="http://www.stefan-michaelis.name">Stefan Michaelis</a> am 28.03.2018
                 </p>
               </div>
               <hr>

          
          
          <ul class="pager">
	    
            <li class="next">
              <a href="/iota/page/2/">Neuer &rarr;</a>
            </li>
	    
	    
	    <li class="previous">
              <a href="/iota/page/4/">&larr; Älter</a>
            </li>
	    
          </ul>
        </div>
      </div>
    </div>

   
    <footer>
      <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <ul class="list-inline text-center">
		
		<li>
                  <a href="https://blog.stefan-michaelis.name/iota/index.xml" type="application/rss+xml" target="_blank">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-circle fa-stack-2x"></i>
                      <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                    </span>
                  </a>
		</li>
		
		<li>
                  <script language="Javascript" type="text/javascript">
		    <!--
			document.write('<a href="mai');
			document.write('lto');
			document.write(':&#105;&#110;&#102;&#111;');
			document.write('@');
			document.write('&#115;&#116;&#101;&#102;&#97;&#110;&#45;&#109;&#105;&#99;&#104;&#97;&#101;&#108;&#105;&#115;&#46;&#110;&#97;&#109;&#101;">');
			
</script>
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-circle fa-stack-2x"></i>
                      <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                    </span>
                    <script language="Javascript" type="text/javascript">
		    <!--
			document.write('<\/a>');
			
		    </script>		
		</li>
		<li>
                  <a href="https://www.xing.com/profile/Stefan_Michaelis5">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-circle fa-stack-2x"></i>
                      <i class="fa fa-xing fa-stack-1x fa-inverse"></i>
                    </span>
                  </a>
		</li>
		<li>
                  <a href="https://de.linkedin.com/in/stefanmichaelis">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-circle fa-stack-2x"></i>
                      <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                    </span>
                  </a>
		</li>
		<li>
                  <a href="https://twitter.com/stmichaelis">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-circle fa-stack-2x"></i>
                      <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                    </span>
                  </a>
		</li>
		<li>
                  <a href="https://github.com/stmichaelis">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-circle fa-stack-2x"></i>
                      <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                    </span>
                  </a>
		</li>
              </ul>
	      <p class="copyright text-muted"><a href="//www.stefan-michaelis.name/contact/de" rel="nofollow">Impressum</a>
		<a href="//www.stefan-michaelis.name/contact/de#privacy" rel="nofollow">Datenschutz</a>
	      </p>
            </div>
          </div>
	</div>
    </footer>

    
    
    
    
    <script src="https://blog.stefan-michaelis.name/js/jquery.min.js"></script>

    
    
    
    <script src="https://blog.stefan-michaelis.name/js/bootstrap.min.js"></script>

    
    <script src="https://blog.stefan-michaelis.name/js/clean-blog.js"></script>
    <script src="https://blog.stefan-michaelis.name/js/shariff.min.js"></script>

    

</body>

</html>

